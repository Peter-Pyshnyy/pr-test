{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Petya/Desktop/proging/webdev/rct/aviation/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Petya/Desktop/proging/webdev/rct/aviation/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/Petya/Desktop/proging/webdev/rct/aviation/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Petya/Desktop/proging/webdev/rct/aviation/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/Petya/Desktop/proging/webdev/rct/aviation/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Petya/Desktop/proging/webdev/rct/aviation/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import\"./component-styles/card.css\";import FlightTicket from\"./FlightTicket\";import{useEffect,useState}from\"react/cjs/react.production.min\";import{jsx as _jsx}from\"react/jsx-runtime\";var TicketList=/*#__PURE__*/function(_React$Component){_inherits(TicketList,_React$Component);var _super=_createSuper(TicketList);function TicketList(){var _this;_classCallCheck(this,TicketList);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={loading:true,ticket:null,displayed:0,sortType:0};_this.changeSortType=function(type){_this.setState({sortType:type});_this.updateList();};_this.updateList=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var arr,sortedArr,res,data,i;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:arr=[];sortedArr=[];_context.next=4;return fetch(\"json/tickets.json\");case 4:res=_context.sent;_context.next=7;return res.json();case 7:data=_context.sent;_context.next=10;return sort(_this.state.sortType,data);case 10:sortedArr=_context.sent;for(i=0;i<5;i++){arr.push(sortedArr[i]);}_this.setState({ticket:arr,loading:false});case 13:case\"end\":return _context.stop();}}},_callee);}));return _this;}_createClass(TicketList,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this.updateList();// const res = await fetch(\"json/tickets.json\");\n// const data = await res.json();\n// sortedArr = await sort(this.state.sortType, data);\n// for (let i = this.state.displayed; i < 5; i++) {\n//   arr.push(sortedArr[i]);\n//   this.setState({ displayed: i });\n// }\n// this.setState({ ticket: arr, loading: false });\ncase 1:case\"end\":return _context2.stop();}}},_callee2,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(\"div\",{children:this.state.loading||!this.state.ticket?/*#__PURE__*/_jsx(\"div\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"ul\",{children:this.state.ticket.map(function(e){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(FlightTicket,{ticket:e})},e.id);})})})});}}]);return TicketList;}(React.Component);export{TicketList as default};function sort(_x,_x2){return _sort.apply(this,arguments);}function _sort(){_sort=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(type,data){var arr;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:arr=data;_context6.t0=type;_context6.next=_context6.t0===0?4:_context6.t0===1?6:_context6.t0===2?8:10;break;case 4:arr.sort(priceSort);return _context6.abrupt(\"break\",11);case 6:arr.sort(durationSort);return _context6.abrupt(\"break\",11);case 8:arr.sort(optimalSort);return _context6.abrupt(\"break\",11);case 10:return _context6.abrupt(\"return\",arr);case 11:console.log(arr);_context6.next=14;return arr;case 14:return _context6.abrupt(\"return\",_context6.sent);case 15:case\"end\":return _context6.stop();}}},_callee6);}));return _sort.apply(this,arguments);}var priceSort=function priceSort(a,b){return a.price-b.price;};// const checkDur = async (e) => {\n//   const segmentA = await getSegments(e);\n//   let durationA = 0;\n//   await segmentA.map((e) => (durationA += e.duration));\n//   console.log(durationA);\n// };\nvar durationSort=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(a,b){var segmentA,segmentB,durationA,durationB;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return getSegments(a);case 2:segmentA=_context3.sent;_context3.next=5;return getSegments(b);case 5:segmentB=_context3.sent;durationA=0;_context3.next=9;return segmentA.map(function(e){return durationA+=e.duration;});case 9:durationB=0;_context3.next=12;return segmentB.map(function(e){return durationB+=e.duration;});case 12:return _context3.abrupt(\"return\",durationA-durationB);case 13:case\"end\":return _context3.stop();}}},_callee3);}));return function durationSort(_x3,_x4){return _ref2.apply(this,arguments);};}();var optimalSort=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(a,b){var segmentA,segmentB,stopsA,stopsB;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return getSegments(a);case 2:segmentA=_context4.sent;_context4.next=5;return getSegments(b);case 5:segmentB=_context4.sent;stopsA=0;_context4.next=9;return segmentA.map(function(e){return stopsA+=e.stops.length;});case 9:stopsB=0;_context4.next=12;return segmentB.map(function(e){return stopsB+=e.stops.length;});case 12:return _context4.abrupt(\"return\",stopsA-stopsB);case 13:case\"end\":return _context4.stop();}}},_callee4);}));return function optimalSort(_x5,_x6){return _ref3.apply(this,arguments);};}();var getSegments=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(ticket){var segments,segmentsAmount,res,data;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:segments=[];segmentsAmount=ticket.segments.length;_context5.next=4;return fetch(\"json/segments.json\");case 4:res=_context5.sent;_context5.next=7;return res.json();case 7:data=_context5.sent;data.map(function(segment){var found=false;for(var i=0;i<segmentsAmount;i++){found=ticket.segments[i]==segment.id;if(found)segments.push(segment);}});return _context5.abrupt(\"return\",segments);case 10:case\"end\":return _context5.stop();}}},_callee5);}));return function getSegments(_x7){return _ref4.apply(this,arguments);};}();","map":{"version":3,"sources":["C:/Users/Petya/Desktop/proging/webdev/rct/aviation/src/components/TicketList.js"],"names":["React","FlightTicket","useEffect","useState","TicketList","state","loading","ticket","displayed","sortType","changeSortType","type","setState","updateList","arr","sortedArr","fetch","res","json","data","sort","i","push","map","e","id","Component","priceSort","durationSort","optimalSort","console","log","a","b","price","getSegments","segmentA","segmentB","durationA","duration","durationB","stopsA","stops","length","stopsB","segments","segmentsAmount","segment","found"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport \"./component-styles/card.css\";\r\nimport FlightTicket from \"./FlightTicket\";\r\nimport { useEffect, useState } from \"react/cjs/react.production.min\";\r\n\r\nexport default class TicketList extends React.Component {\r\n  state = {\r\n    loading: true,\r\n    ticket: null,\r\n    displayed: 0,\r\n    sortType: 0,\r\n  };\r\n\r\n  changeSortType = (type) => {\r\n    this.setState({ sortType: type });\r\n    this.updateList();\r\n  };\r\n\r\n  updateList = async () => {\r\n    let arr = [];\r\n    let sortedArr = [];\r\n\r\n    const res = await fetch(\"json/tickets.json\");\r\n    const data = await res.json();\r\n    sortedArr = await sort(this.state.sortType, data);\r\n\r\n    for (let i = 0; i < 5; i++) {\r\n      arr.push(sortedArr[i]);\r\n    }\r\n    this.setState({ ticket: arr, loading: false });\r\n  };\r\n\r\n  async componentDidMount() {\r\n    this.updateList();\r\n\r\n    // const res = await fetch(\"json/tickets.json\");\r\n    // const data = await res.json();\r\n    // sortedArr = await sort(this.state.sortType, data);\r\n\r\n    // for (let i = this.state.displayed; i < 5; i++) {\r\n    //   arr.push(sortedArr[i]);\r\n    //   this.setState({ displayed: i });\r\n    // }\r\n    // this.setState({ ticket: arr, loading: false });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        {this.state.loading || !this.state.ticket ? (\r\n          <div>Загрузка...</div>\r\n        ) : (\r\n          <div>\r\n            <ul>\r\n              {this.state.ticket.map((e) => {\r\n                return (\r\n                  <li key={e.id}>\r\n                    <FlightTicket ticket={e} />\r\n                  </li>\r\n                );\r\n              })}\r\n            </ul>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nasync function sort(type, data) {\r\n  let arr = data;\r\n\r\n  switch (type) {\r\n    case 0:\r\n      arr.sort(priceSort);\r\n      break;\r\n    case 1:\r\n      arr.sort(durationSort);\r\n      break;\r\n    case 2:\r\n      arr.sort(optimalSort);\r\n      break;\r\n    default:\r\n      return arr;\r\n  }\r\n\r\n  console.log(arr);\r\n  return await arr;\r\n}\r\n\r\nconst priceSort = (a, b) => {\r\n  return a.price - b.price;\r\n};\r\n\r\n// const checkDur = async (e) => {\r\n//   const segmentA = await getSegments(e);\r\n\r\n//   let durationA = 0;\r\n//   await segmentA.map((e) => (durationA += e.duration));\r\n\r\n//   console.log(durationA);\r\n// };\r\n\r\nconst durationSort = async (a, b) => {\r\n  const segmentA = await getSegments(a);\r\n  const segmentB = await getSegments(b);\r\n\r\n  let durationA = 0;\r\n  await segmentA.map((e) => (durationA += e.duration));\r\n\r\n  let durationB = 0;\r\n  await segmentB.map((e) => (durationB += e.duration));\r\n\r\n  return durationA - durationB;\r\n};\r\n\r\nconst optimalSort = async (a, b) => {\r\n  const segmentA = await getSegments(a);\r\n  const segmentB = await getSegments(b);\r\n\r\n  let stopsA = 0;\r\n  await segmentA.map((e) => (stopsA += e.stops.length));\r\n\r\n  let stopsB = 0;\r\n  await segmentB.map((e) => (stopsB += e.stops.length));\r\n\r\n  return stopsA - stopsB;\r\n};\r\n\r\nconst getSegments = async (ticket) => {\r\n  let segments = [];\r\n  let segmentsAmount = ticket.segments.length;\r\n  const res = await fetch(\"json/segments.json\");\r\n  const data = await res.json();\r\n\r\n  data.map((segment) => {\r\n    let found = false;\r\n    for (let i = 0; i < segmentsAmount; i++) {\r\n      found = ticket.segments[i] == segment.id;\r\n\r\n      if (found) segments.push(segment);\r\n    }\r\n  });\r\n  return segments;\r\n};\r\n"]},"metadata":{},"sourceType":"module"}